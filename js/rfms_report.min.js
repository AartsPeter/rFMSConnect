function FilterDBVehicle(){ClearVehicleMessage();var a=document.getElementById("vehicles").value,b=new Date(document.getElementById("SelectDate").value).format("yyyy/mm/dd H:MM"),c=new Date(document.getElementById("SelectDateEnd").value).format("yyyy/mm/dd H:MM"),d=$("#TripReport"),e=$("#TripTable");if(e.html(""),rFMS_Markers.clearLayers(),rFMS_Trigger.clearLayers(),rFMS_Trip.clearLayers(),""==a.length)return d.html(""),void d.append("<div class='notice-warning' ><strong>No vehicle selected !</div>");var f=new moment(document.getElementById("SelectDate").value),g=new moment(document.getElementById("SelectDateEnd").value),h=g.diff(f,"days"),i=$("#TripSumReport"),j=$("#TripDetailsTimeline");j.html("");var k=0,l=0;$TCO2=0;$TFE=0,$counter=0,$Tcounter=0,$Str="";ShowPlaceholder("TripTable","table"),ShowPlaceholder("TripSumReport","sumreport"),$counter=0,$.ajax({url:window.location.origin+"/scripts/GetTripsDetails.php?id="+a+"&StartDate="+b+"&EndDate="+c,dataType:"JSON",type:"GET",success:function(a){0<a.length?(d.html(""),$.each(a,function(a,b){l+=parseFloat(b.Distance),k+=parseFloat(b.FuelUsed),$TCO2+=parseFloat(b.CO2_emission),$Tcounter+=parseFloat(b.amountTrips),$counter++}),$FuelUsage=100/(l/k),$TFE+=parseFloat($FuelUsage),i.html(""),$Str+="<div class=\"row\">",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"trips p-2\">\t\t<span><small>Trips</small>\t</span></br><span class=\"info-box-number\">"+formatNumber($counter)+"</span></div></div>",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"distance p-2\">\t<span><small>Distance </small></span></br><span class=\"info-box-number\">"+formatNumber(l.toFixed(0))+"</b> <small>km</small></div></div>",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"fuelused p-2\">\t<span><small>Fuel used </small></span></br><span class=\"info-box-number\">"+formatNumber(k.toFixed(0))+"</b> <small>L</small></div></div>",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"fuelusage p-2\">\t<span><small>Fuel Economy </small></span></br><span class=\"info-box-number\">"+formatNumber($TFE.toFixed(2))+" </b> <small>L/100km</small></div></div>",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"co2 p-2\">\t\t<span><small>CO2 </small></span></br><span class=\"info-box-number\">"+formatNumber($TCO2.toFixed(0))+"</b> <small>kg</small></div></div>",$Str+="<div class=\"form-group col-xl-2 col-lg-4 col-6\"><div class=\"days p-2\">\t\t<span><small>Days </small></span></br><span class=\"info-box-number\">"+h+"</b></div></div>",$Str+="</div>",i.append($Str),UpdateCounter("","TripTable"),ShowTableVehicleTrips(a)):(UpdateCounter("","TripTable"),i.html(""),d.html(""),d.append("<div class='notice-danger' ><strong>No trip data found !</div>"))}})}function ClearVehicleMessage(){var a=$("#TripReport");a.html("");var a=$("#TripSumReport");a.html("");var a=$("#VehicleInfoTrip");a.html("")}function SelectCustomerVehicles(){if($select=$("#vehicles"),$select.html(""),"*"==document.getElementById("groups").value)$select.append("<option value=\"\" selected> <i>First select a group</i></option>");else{var a=$("#TripReport");a.html(""),$.ajax({url:window.location.origin+"/scripts/GetCustomerVehicles.php",dataType:"JSON",success:function(a){$selected="selected",$.each(a,function(a,b){"1"==b.vehicleActive?$select.append("<option value=\""+b.id+"\" "+$selected+">"+b.customerVehicleName+" ("+b.LicensePlate+")</option>"):$select.append("<option value=\""+b.id+"\" class=\"select_old\" "+$selected+">"+b.customerVehicleName+" *("+b.LastActivity+") </option>"),"selected"==$selected&&($selected="")}),FilterDBVehicle()}})}}function ShowTripTable(a){$("#TripTable").DataTable({createdRow:function(a,b){!0==b.tripdelayed&&$(a).addClass("delayedrow")},data:a,autoWidth:!0,destroy:!0,order:[[1,"desc"]],dom:"Bfltirp",lengthMenu:[[10,75,200,-1],[10,75,200,"All"]],bLengthChange:!1,language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},buttons:{buttons:[{extend:"excel",className:"btn btn-primary btn-sm",filename:"rFMSReader_Trip-Data_"+document.getElementById("vehicles").value},{extend:"pdf",className:"btn btn-primary btn-sm",orientation:"landscape",pageSize:"A3",messageTop:"Trip-data for selected vehicle "+document.getElementById("vehicles").value},{extend:"print",className:"btn btn-primary btn-sm",messageTop:"Trip-data for selected vehicle "+document.getElementById("vehicles").value}]},columns:[{data:"VIN",title:"vehicle",visible:!1,defaultContent:"-"},{data:"starttrip",title:"starttrip UTC",defaultContent:"-"},{data:"endtrip",title:"Trip End UTC",defaultContent:"-"},{data:"StartOdo",title:"Odo-meter Start",defaultContent:"-",width:"7%"},{data:"EndOdo",title:"Odo-meter End",defaultContent:"-",width:"7%"},{data:"driver1",title:"Driver",defaultContent:"-",width:"8%"},{data:"duration",title:"Duration (hh:mm)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"distance",title:"Distance (km)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"averagespeed",title:"Avg. Speed (km/u)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"averageweight",title:"Avg. Weight (kg)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"fuelused",title:"Fuel Used (L)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"fuelusage",title:"Economy (l/100km)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"startdelay",title:"Delay at start (hh:mm)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"enddelay",title:"Delay at end (hh:mm)",defaultContent:"-",className:"dt-right",width:"5%"},{data:"tripdelayed",title:"delayed",defaultContent:"-",className:"dt-center",width:"3%"}]})}function ShowVehicleTable(a){$("#tableVehicles").DataTable({data:a,autoWidth:!0,destroy:!0,order:[[1,"asc"]],dom:"Bfltirp",lengthMenu:[[25,75,200,-1],[25,75,200,"All"]],bLengthChange:!1,language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},buttons:{buttons:[{extend:"excel",className:"btn btn-primary btn-sm"},{extend:"pdf",className:"btn btn-primary btn-sm",orientation:"landscape",pageSize:"A3",messageTop:"Active Vehicles"},{extend:"print",className:"btn btn-primary btn-sm"}]},columns:[{data:"customerVehicleName",title:"Vehicle Name",className:"dt-left"},{data:"Name",title:"Customer Name",defaultContent:"",className:"dt-left",width:"14%"},{data:"LicensePlate",title:"License Plate",defaultContent:"",className:"dt-right",width:"3%"},{data:"model",title:"model",defaultContent:"",className:"dt-right",width:"5%"},{data:"Year",title:"Production Year",className:"dt-right",width:"54"},{data:"OdoMeter",title:"ODO Meter",defaultContent:"",className:"dt-right",width:"5%"},{data:"serviceDistance",title:"Service Distance",defaultContent:"",className:"dt-right",width:"4%"},{data:"LastActivity",title:"Last Contact",defaultContent:""},{data:"LastDriver",title:"Last Driver",defaultContent:"",className:"dt-left",width:"10%"},{data:"FuelLevel",title:"Fuel in %",defaultContent:"",className:"dt-right",width:"5%"},{data:"catalystFuelLevel",title:"Adblue level in %",defaultContent:"",className:"dt-right",width:"5%"},{data:"TotalFuelUsed",title:"Total Fuel Used in ml",defaultContent:"",className:"dt-right",width:"5%"},{data:"obu_sw_version",title:"OBU Version",defaultContent:""},{data:"VIN",title:"Vin"}]})}function MissingDistance(a,b){if(0>=a)return!1;if(0>=b)return!1;return!!(2e3<Math.abs(a-b))}function CreateMarkMissingDistance(a,b,c){var d={},e=Math.abs(a-b)/1e3;return d.distance=e.toFixed(3),d.VIN="Missing Distance",d.starttrip=new Date(c).format("yyyy/mm/dd HH:MM:ss"),d}function StartDBValidation(a){for(var b=[],c=!0,d=0,e=0,f=[],g=0;g<a.length;++g){if("ENGINE_ON"==a[g].triggerType&&!1==c&&(c=!0,e=a[g].hrTotalVehicleDistance),"ENGINE_ON"==a[g].triggerType&&!0==c){var h=[];d=a[g].hrTotalVehicleDistance,f.push(a[g]),h=TripDBValidate(f),0<h.distance&&b.push(h),f=[],c=!0,e=a[g].hrTotalVehicleDistance}if("ENGINE_OFF"==a[g].triggerType){var h=[];d=a[g].hrTotalVehicleDistance,f.push(a[g]),h=TripDBValidate(f),0<h.distance&&b.push(h),f=[],c=!1}!0==c&&f.push(a[g])}ShowTripTable(b)}function DrawTripSpeed(){for(var a=[[new Date(markers[0].createdDateTime),0]],b=1;b<markers.length;++b)a.push([new Date(markers[b].createdDateTime),parseFloat(markers[b].wheelBasedSpeed)]);a.push([new Date(markers[b-1].createdDateTime),0]),Highcharts.chart("TripSpeed",{chart:{type:"areaspline",zoomType:"x",marginLeft:120,marginRight:40,styledMode:!0},title:{text:"Vehicle Speed",margin:0,style:{color:"#888",fontSize:"15px",fontWeight:"normal"}},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]}},yAxis:{title:{text:"Vehicle Speed (km/u)"},tickInterval:25,min:0,max:110},tooltip:{headerFormat:"",pointFormat:"<span style=\"color:{point.color}\">{point.x:%e %b %H:%M} <br><b>{point.y}</b> km/h </span>",crosshairs:!0,shared:!0,useHTML:!0},plotOptions:{spline:{marker:{enabled:!0}},series:{turboThreshold:1,animation:!1,fillColor:"#ddd"}},colors:["#266cab"],credits:{enabled:!1},legend:{enabled:!1},series:[{name:"Speed",data:a,colorIndex:"4"}]})}function DrawTripDistance(){for(var a,b=[],c=1;c<markers.length;++c)a=(markers[c].hrTotalVehicleDistance-markers[c-1].hrTotalVehicleDistance)/1e3,b.push([new Date(markers[c].createdDateTime),parseFloat(a)]);b.push([new Date(markers[c-1].createdDateTime),0]),Highcharts.chart("TripDistance",{chart:{type:"column",zoomType:"x",marginLeft:120,marginRight:40,styledMode:!0},title:{text:"Distance per Timer",margin:0},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]}},yAxis:{title:{text:"Distance <br>km"},tickInterval:5,min:0,max:20},tooltip:{headerFormat:"",pointFormat:"<span style=\"color:{point.color}\">{point.x:%e %b %H:%M} <br><b>{point.y}</b> km </span>",crosshairs:!0,shared:!0},plotOptions:{column:{pointPadding:.2,pointWidth:5,borderWidth:0},spline:{marker:{enabled:!0}},series:{turboThreshold:1,animation:!1}},credits:{enabled:!1},legend:{enabled:!1},series:[{name:"Distance",data:b,colorIndex:"4"}]})}function DrawTripFuel(){var a=[],b=[],c=[];a.push([new Date(markers[0].createdDateTime),0]);for(var d=0;d<markers.length;++d)0<markers[d].fuelLevel1&&a.push([new Date(markers[d].createdDateTime),parseFloat(markers[d].fuelLevel1)]),0<markers[d].catalystFuelLevel&&c.push([new Date(markers[d].createdDateTime),parseFloat(markers[d].catalystFuelLevel)]),0<markers[d].engineTotalFuelUsed&&b.push([new Date(markers[d].createdDateTime),parseFloat(markers[d].engineTotalFuelUsed)]);Highcharts.chart("TripFuel",{chart:{type:"line",zoomType:"x",marginLeft:120,marginRight:40,styledMode:!0},title:{text:"Fuel level",margin:0,style:{color:"#888",fontSize:"15px",fontWeight:"normal"}},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]}},yAxis:[{title:{text:"Fuellevel & Adblue in %"},tickInterval:25,min:0,max:100}],tooltip:{headerFormat:"",pointFormat:"<span style=\"color:{point.color}\"><b>{series.name}</b><br>{point.x:%e %b %H:%M} <br><b>{point.y}</b> %</span>",crosshairs:!0,shared:!1,useHTML:!0},plotOptions:{spline:{marker:{enabled:!1}},series:{turboThreshold:1,animation:!1}},credits:{enabled:!1},legend:{enabled:!1},series:[{name:"Fuellevel",data:a,color:"#8AC543",step:"left"},{name:"AdBlue",data:c,color:"#266CAB",step:"left"}]})}function DrawTripFuelUsage(){var a=[],b=[];a.push([new Date(markers[0].createdDateTime),0]);for(var c=0;c<markers.length;++c)0<markers[c].engineTotalFuelUsed&&b.push([markers[c].createdDateTime,markers[c].engineTotalFuelUsed,markers[c].hrTotalVehicleDistance]);for(var d=1;d<b.length;++d){var e=b[d][1]-b[d-1][1],f=b[d][2]-b[d-1][2];a.push([new Date(b[d][0]),parseFloat(100/(f/e))])}a.push([new Date(markers[c-1].createdDateTime),0]),Highcharts.chart("TripFuelUsage",{chart:{type:"spline",zoomType:"x",marginLeft:120,marginRight:40,styledMode:!0},title:{text:"Fuel Economy",margin:0},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]},startOnTick:!0,endOnTick:!0},yAxis:{title:{text:"FuelUsage L/100 km"},tickInterval:10,min:0,max:100},tooltip:{headerFormat:"",pointFormat:"{point.x:%e %b %Y <br>%H:%M}: <b>{point.y:.2f}</b> L/100km",crosshairs:!0,shared:!0},plotOptions:{column:{pointPadding:.2,pointWidth:5,borderWidth:0},spline:{marker:{enabled:!0}},series:{turboThreshold:1,animation:!1}},credits:{enabled:!1},legend:{enabled:!1},series:[{name:"FuelUsage L/100 km",data:a}]})}function DrawTripWeight(){for(var a=[[new Date(markers[0].createdDateTime),0]],b=0;b<markers.length;++b)65e3>markers[b].grossCombinationVehicleWeight&&0<markers[b].grossCombinationVehicleWeight&&a.push([new Date(markers[b].createdDateTime),parseFloat(markers[b].grossCombinationVehicleWeight)]);a.push([new Date(markers[b-1].createdDateTime),0]),Highcharts.chart("TripWeight",{chart:{type:"line",zoomType:"x",marginLeft:120,marginRight:40,styledMode:!0},title:{text:"Vehicle Weight",margin:0,style:{color:"#888",fontSize:"15px",fontWeight:"normal"}},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]}},yAxis:{title:{text:"Weight in KG"},tickInterval:1e4,min:8e3,max:6e4},tooltip:{headerFormat:"",pointFormat:"<span style=\"color:{point.color}\">{point.x:%e %b %H:%M} <br><b>{point.y}</b> kg</span>",crosshairs:!0,shared:!0},plotOptions:{spline:{marker:{enabled:!0}},series:{turboThreshold:1,animation:!1,fillColor:"#ddd"}},colors:["#FC5F01"],credits:{enabled:!1},legend:{enabled:!1},series:[{name:"Vehicle weight in kg",data:a,step:"left"}]})}function setTTColor(a){return $color="6","YELLOW"==a&&($color="11"),"INFO"==a&&($color="4"),"OFF"==a&&($color="9"),"RED"==a&&($color="5"),"DRIVE"==a&&($color="7"),"WORK"==a&&($color="8"),"REST"==a&&($color="6"),"AVAILABLE"==a&&($color="10"),"NOT_AVAILABLE"==a&&($color="9"),$color}function DrawTellTaleGraph(a){var b=[],c={},d={},e={},f={},g={},h={},i={};c.x=Date.parse(a[0].createdDateTime),c.x2="",c.y=0,c.status="off",c.colorIndex="9",d.x=Date.parse(a[0].createdDateTime),d.x2="",d.y=1,d.status="off",d.colorIndex="9",e.x=Date.parse(a[0].createdDateTime),e.x2="",e.y=2,e.status="off",e.colorIndex="9",f.x=Date.parse(a[0].createdDateTime),f.x2="",f.y=3,f.status="off",f.colorIndex="9",g.x=Date.parse(a[0].createdDateTime),g.x2="",g.y=4,g.status="off",g.colorIndex="9",h.x=Date.parse(a[0].createdDateTime),h.x2="",h.y=5,h.status="off",h.colorIndex="9",i.x=Date.parse(a[0].createdDateTime),i.x2="",i.y=6,i.status="off",i.colorIndex="9";for(var j=0;j<a.length;++j)if("TELL_TALE"==a[j].triggerType){var k=a[j].triggerInfo,l=k.indexOf("->"),m=k.substring(0,l),n=k.substring(l+2,k.length);"PARKING_BRAKE"==m&&c.status!=n&&(c.x2=Date.parse(a[j].createdDateTime),b.push(c),j<a.length&&(c={},c.x=Date.parse(a[j].createdDateTime),c.x2="",c.y=0,c.status=n,c.colorIndex=setTTColor(n))),"FUEL_LEVEL"==m&&d.status!=n&&(d.x2=Date.parse(a[j].createdDateTime),b.push(d),j<a.length&&(d={},d.x=Date.parse(a[j].createdDateTime),d.x2="",d.y=1,d.status=n,d.colorIndex=setTTColor(n))),"ENGINE_MIL_INDICATOR"==m&&f.status!=n&&(f.x2=Date.parse(a[j].createdDateTime),b.push(f),j<a.length&&(f={},f.x=Date.parse(a[j].createdDateTime),f.x2="",f.y=3,f.status=n,f.colorIndex=setTTColor(n))),"ENGINE_EMISSION_FAILURE"==m&&i.status!=n&&(i.x2=Date.parse(a[j].createdDateTime),b.push(i),j<a.length&&(i={},i.x=Date.parse(a[j].createdDateTime),i.x2="",i.y=6,i.status=n,i.colorIndex=setTTColor(n)))}Highcharts.chart("TripTT",{chart:{type:"xrange",zoomType:"x",marginLeft:120,marginRight:40},title:{text:"Tell_tale Warnings",margin:0},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%H:00",minute:"%H:%M"},title:{text:""},tickInterval:144e5,labels:{autoRotation:[-30,-40]}},yAxis:{title:{text:""},categories:["Parking Brake","Fuel Level","AdBlue Level","EngineMil Indicator","Engine Oil","Engine Collant Temperature","Engine Emission Failure"],reversed:!0},tooltip:{xDateFormat:"%H:%M:%S",headerFormat:"{point.x} - {point.x2}",pointFormat:"<br/>Status : <b>{point.status}</b>",crosshairs:!1,shared:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{borderRadius:0,borderWidth:0,pointWidth:15,data:b}]})}function ReadVehicleAlerts(a,b,c){if(""==a)var d=document.getElementById("vehicles").value;else var d=a;if(""==b)var e=new Date(document.getElementById("SelectDate").value).format("yyyy/mm/dd");else var e=b;if(""==c)var f=new Date(document.getElementById("SelectDateEnd").value).format("yyyy/mm/dd");else var f=c;$TellTales=[],$.ajax({url:window.location.origin+"/scripts/GetVehicleAlerts.php?id="+d+"&StartDate="+e+"&EndDate="+f,dataType:"JSON",type:"GET",success:function(a){$.each(a,function(a,b){$TellTales.push(b)}),0<$TellTales.length&&ShowTellTaleTable($TellTales)}})}function ShowTellTaleTable(a){$("#Alertdata").DataTable({data:a,autoWidth:!1,destroy:!0,order:[[1,"desc"]],bLengthChange:!1,dom:"Bfltirp",scrollY:"58vh",bInfo:!0,scrollCollapse:!0,paging:!1,scrollX:!0,language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},buttons:{buttons:[{extend:"pdf",className:"btn btn-primary btn-sm",orientation:"landscape",pageSize:"A3",messageTop:"rFMSReader_Trip-Alerts"},{extend:"print",className:"btn btn-primary btn-sm",messageTop:"rFMSReader_Trip-Alerts"}]},columns:[{data:"vin",title:"Vehicle ",className:"dt-left",visible:!1,width:"20%"},{data:"createdDateTime",title:"Date",defaultContent:"",width:"33%"},{data:"Driver_ID",title:"Driver",defaultContent:"",className:"dt-left",width:"33%"},{data:"tellTale",title:"Warning",defaultContent:"",className:"dt-left",width:"33%"},{data:"state",title:"Status",defaultContent:"",className:"dt-right",width:"33%"},{data:"latitude",title:"",defaultContent:"",className:"dt-right",width:"33%",visible:!1},{data:"longitude",title:"",defaultContent:"",className:"dt-right",width:"33%",visible:!1}]})}function ReadGroupTrips(){UpdateCounter("","DetailsTableHeaderPH"),UpdateCounter("","TripsTableHeaderPH"),UpdateCounter("","TripReport"),UpdateCounter("","TripsTableHeader"),ShowPlaceholder("FleetTripReport","graph"),ShowPlaceholder("FleetFuelReport","graph"),ShowPlaceholder("FleetSumReport","sumreport"),ShowPlaceholder("TripsTableHeaderPH","table");var a=new Date(document.getElementById("SelectDate").value).format("yyyy/mm/dd H:MM"),b=new Date(document.getElementById("SelectDateEnd").value).format("yyyy/mm/dd 23:59"),c=new Date(document.getElementById("SelectDate").value),d=new Date(document.getElementById("SelectDateEnd").value),e=$("#TripReport");e.html("<div class='loader' id='tableloader'></div>");$TCO2=0;$TFE=0,$counter=0,$Tcounter=0,$Str="",markers=[],$counter=0,$.ajax({url:window.location.origin+"/scripts/GetTripSummary.php?StartDate="+a+"&EndDate="+b,dataType:"JSON",type:"GET",success:function(a){0<a.length?(e.html(""),ShowTripSumTable(a),FleetTripData()):(e.html(""),e.append("<div class='notice-danger' ><strong>No trip data found !</div>"))}})}function ShowTripsTable(a,b){var c=$("#DetailsTableHeaderPH");c.html("");var d="\t<div class=\"page-title\" >";d+="\t\t<div class=\"mr-auto\">TripDetails for selected vehicle <span class=\"text-primary\"><b><u>"+b+"</u></b></span></div>",d+="\t</div>",c.append(d);var e=new Date(document.getElementById("SelectDate").value).format("yyyy/mm/dd H:MM"),f=new Date(document.getElementById("SelectDateEnd").value).format("yyyy/mm/dd H:MM"),g=$("#TripsDetailsTable").DataTable({ajax:{url:window.location.origin+"/scripts/GetTripsDetails.php?id="+a+"&StartDate="+e+"&EndDate="+f,dataSrc:""},language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},oLanguage:{sProcessing:""},processing:!0,paging:!0,pageResize:!0,bLengthChange:!1,lengthMenu:[[5,-1],[5,"All"]],autoWidth:!1,destroy:!0,order:[[1,"asc"]],dom:"Bfltirp",bInfo:!0,scrollCollapse:!0,scrollX:!0,deferRender:!0,buttons:{buttons:[{extend:"excel",className:"btn btn-sm",title:"rFMS_reader Groups_Overview"},{extend:"pdf",className:"btn btn-sm",orientation:"landscape",pageSize:"A4",messageTop:"Groups Overview",title:"rFMS_reader Groups_Overview"},{extend:"csv",text:"CSV",className:"btn btn-sm",extension:".csv",fieldSeparator:";"},{extend:"print",className:"btn btn-sm"}]},columns:[{data:"customerVehicleName",title:"vehicle",visible:!1,defaultContent:"-"},{data:"StartDate",title:"Start Time UTC",defaultContent:"-"},{data:"EndDate",title:"End Trip UTC",defaultContent:"-"},{data:"start_odometer",title:"Start Odo-meter",visible:!1,defaultContent:"-"},{data:"end_odometer",title:"End Odo-meter",visible:!1,defaultContent:"-"},{data:"Driver",title:"Driver",defaultContent:"-"},{data:"Driver2ID",title:"Driver-2",visible:!1,defaultContent:"-"},{data:"Duration",title:"Duration (hh:mm)",defaultContent:"-",className:"dt-center"},{data:"DriveTime",title:"DriveTime",visible:!0,defaultContent:"-",className:"dt-center"},{data:"IdleTime",title:"IdleTime",visible:!0,defaultContent:"-",className:"dt-center"},{data:"PreDepIdle",title:"Idle before trip",defaultContent:"-",className:"dt-center"},{data:"Distance",title:"Distance (km)",defaultContent:"-",className:"dt-center"},{data:"FuelUsed",title:"Fuel Used (L)",defaultContent:"-",className:"dt-center"},{data:"CO2_emission",title:"CO2 (kg/l)",defaultContent:"-",className:"dt-center"},{data:"FuelUsage",title:"Fuel Usage (L/100km)",defaultContent:"-",className:"dt-center"},{data:"AverageSpeed",title:"Average Speed",visible:!1,defaultContent:"-",className:"dt-center"},{data:"CounterT_E",title:"Calc Timer Count",visible:!1,defaultContent:"-",className:"dt-right"},{data:"CounterT",title:"Actual Timer Count",visible:!1,defaultContent:"-",className:"dt-right"},{data:"VIN",title:"",visible:!1,defaultContent:"-"},{data:"TripReliability",title:"Reliability in %",visible:!1,defaultContent:"-",className:"dt-right"},{data:"CruiseControlTime",title:"CC-Time",visible:!1,defaultContent:"-",className:"dt-right"},{data:"CruiseControleDistance",title:"CC-Distance",visible:!1,defaultContent:"-",className:"dt-right"},{data:"RetarderTime",title:"Retarder Time",visible:!1,defaultContent:"-",className:"dt-right"},{data:"RetarderDistance",title:"Retarder Distance",visible:!1,defaultContent:"-",className:"dt-right"},{data:"AverageDrivingSpeed",title:"Average Driving Speed",visible:!1,defaultContent:"-",className:"dt-right"},{data:"HighestDrivingSpeed",title:"Highest Driving Speed",visible:!1,defaultContent:"-",className:"dt-right"},{data:"start_latitude",title:"Start Lat",visible:!1,defaultContent:"-",className:"dt-right"},{data:"start_longitude",title:"Start Lng",visible:!1,defaultContent:"-",className:"dt-right"},{data:"end_latitude",title:"End Lat",visible:!1,defaultContent:"-",className:"dt-right"},{data:"end_longitude",title:"End lng",visible:!1,defaultContent:"-",className:"dt-right"}]});$("#TripsDetailsTable").off("click"),$("#TripsDetailsTable").on("click","tr",function(){var a=g.row(this).data();jQuery.noConflict(),$("#EditTripModal").modal("show"),ShowTripMap(a.Trip_NO)})}function ShowTableVehicleTrips(a){var b=new Date(document.getElementById("SelectDate").value).format("yyyy/mm/dd H:MM"),c=new Date(document.getElementById("SelectDateEnd").value).format("yyyy/mm/dd H:MM"),d=$("#TripTable").DataTable({data:a,language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},oLanguage:{sProcessing:"<div id='tableloader'></div>"},processing:!0,paging:!0,pageResize:!0,searching:!1,lengthMenu:[[5,-1],[5,"All"]],autoWidth:!1,destroy:!0,order:[[0,"asc"]],dom:"Bfltirp",bInfo:!0,scrollCollapse:!0,scrollX:!0,deferRender:!0,bLengthChange:!1,buttons:{buttons:[]},columns:[{data:"StartDate",title:"Start Time UTC",defaultContent:"-",width:"15%"},{data:"Driver",title:"Driver",defaultContent:"-",width:"15%"},{data:"Duration",title:"Duration (hh:mm)",defaultContent:"-",className:"dt-center"},{data:"DriveTime",title:"DriveTime",visible:!0,defaultContent:"-",className:"dt-center"},{data:"IdleTime",title:"IdleTime",visible:!0,defaultContent:"-",className:"dt-center"},{data:"PreDepIdle",title:"Idle before trip",visible:!1,defaultContent:"-",className:"dt-center"},{data:"Distance",title:"Distance (km)",defaultContent:"-",className:"dt-center"},{data:"FuelUsed",title:"Fuel Used (L)",defaultContent:"-",className:"dt-center"},{data:"CO2_emission",title:"CO2 (kg/l)",visible:!1,defaultContent:"-",className:"dt-center"},{data:"FuelUsage",title:"Fuel Usage (L/100km)",defaultContent:"-",className:"dt-center"},{data:"TripReliability",title:"Q",defaultContent:"-",className:"dt-center"},{data:"EndDate",title:"End Trip UTC",defaultContent:"-",width:"15%",className:"dt-right"}]});$("#TripTable").off("click"),$("#TripTable").on("click","tr",function(){var a=d.row(this).data();ShowTripMap(a.Trip_NO)})}function ShowTripSumTable(a){var b=$("#TripsTableHeaderPH");b.html("");var c="<div class=\"\" >";c+="\t\t<div class=\"page-title\">TripSummary for all vehicles</div>",c+="\t\t<div class=\"card-body p-0\" >",c+="\t\t<table id=\"TripsTable\" class=\"pageResize table table-hover noWrap\" width=\"100%\"></table></div></div>",b.append(c);var d=$("#TripsTable").DataTable({data:a,language:{search:"<i class=\"fad fa-fw fa-filter\" aria-hidden=\"true\"></i>",searchPlaceholder:"filter records"},autoWidth:!1,destroy:!0,fixedColumns:!0,scrollX:!0,scrollCollapse:!0,order:[[0,"asc"]],dom:"Bfltirp",lengthMenu:[[5,25,100,-1],[5,25,100,"All"]],bLengthChange:!1,buttons:{buttons:[{extend:"excel",className:"btn btn-sm",filename:"rFMSReader_Trip-Data"},{extend:"pdf",className:"btn btn-sm",orientation:"landscape",pageSize:"A3",messageTop:"Trip-data "},{extend:"csv",text:"CSV",className:"btn btn-sm",extension:".csv",fieldSeparator:";"},{extend:"print",className:"btn btn-sm",orientation:"landscape",pageSize:"A3",messageTop:"Trip-data "}]},columns:[{data:"customerVehicleName",title:"Vehicle",defaultContent:"-"},{data:"Distance",title:"Distance (km)",defaultContent:"-",className:"dt-center"},{data:"Duration",title:"Duration (hh:mm)",defaultContent:"-",className:"dt-center"},{data:"DriveTime",title:"DrivingTime",defaultContent:"-",className:"dt-center"},{data:"FuelUsed",title:"Fuel Used (L)",defaultContent:"-",className:"dt-center"},{data:"CO2_emission",title:"CO2 (kg/l)",defaultContent:"-",className:"dt-center"},{data:"FuelUsage",title:"Fuel Usage (L/100km)",defaultContent:"-",className:"dt-center"},{data:"amountTrips",title:"Trips #",defaultContent:"-",className:"dt-center"}]});$("#TripsTable").off("click"),$("#TripsTable").on("click","tr",function(a){a.preventDefault();var b=d.row(this).data();ShowTripsTable(b.id,b.customerVehicleName)})}